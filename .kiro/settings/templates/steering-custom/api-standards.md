# API標準

[目的: 命名、構造、認証、バージョニング、エラーに関する一貫したAPIパターン]

## 哲学
- 予測可能でリソース指向の設計を優先
- 契約を明示的に。破壊的変更を最小限に
- デフォルトでセキュア（認証優先、最小権限）

## エンドポイントパターン
```
/{version}/{resource}[/{id}][/{sub-resource}]
```
例:
- `/api/v1/users`
- `/api/v1/users/:id`
- `/api/v1/users/:id/posts`

HTTPメソッド:
- GET（読み取り、安全、冪等）
- POST（作成）
- PUT/PATCH（更新）
- DELETE（削除、冪等）

## リクエスト/レスポンス

リクエスト（一般的）:
```json
{ "data": { ... }, "metadata": { "requestId": "..." } }
```

成功:
```json
{ "data": { ... }, "meta": { "timestamp": "...", "version": "..." } }
```

エラー:
```json
{ "error": { "code": "ERROR_CODE", "message": "...", "field": "optional" } }
```
（ルールについてはerror-handlingを参照。）

## ステータスコード（パターン）
- 2xx: 成功（200 読み取り、201 作成、204 削除）
- 4xx: クライアント問題（400 検証、401/403 認証、404 未検出）
- 5xx: サーバー問題（500 汎用、503 利用不可）
結果を最もよく反映するステータスを選択。

## 認証
- 標準的な場所に認証情報
```
Authorization: Bearer {token}
```
- ビジネスロジック前に未認証を拒否

## バージョニング
- URL/ヘッダー/メディアタイプでバージョン管理
- 破壊的変更 → 新バージョン
- 非破壊的変更 → 同バージョン
- 非推奨化の猶予期間と通知を提供

## ページネーション/フィルタリング（該当する場合）
- ページネーション: `page`, `pageSize` またはカーソルベース
- フィルタリング: 明示的なクエリパラメータ
- ソート: `sort=field:asc|desc`
`meta`にページネーションメタデータを返す。

---
_エンドポイントカタログではなく、パターンと決定事項に焦点を当てる。_
